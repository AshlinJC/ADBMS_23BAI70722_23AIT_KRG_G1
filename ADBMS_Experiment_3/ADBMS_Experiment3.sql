--Using AIT_1A Database 
USE AIT_1A
--Easy Level Problem

CREATE TABLE EMP (EMPID INT);
INSERT INTO EMP VALUES 
(2),
(4), 
(4), 
(6), 
(6), 
(7), 
(8), 
(8);
SELECT MAX(EMPID) FROM EMP
WHERE EMPID NOT IN (
    SELECT * FROM EMP 
    GROUP BY EMPID 
    HAVING COUNT(EMPID) > 1
);

--Medium Level Problem
CREATE TABLE depart (
    id INT PRIMARY KEY,
    dept_name VARCHAR(50)
);
CREATE TABLE employee (
    id INT,
    name VARCHAR(50),
    salary INT,
    depart_id INT,
    FOREIGN KEY (depart_id) REFERENCES depart(id)
);
INSERT INTO depart (id, dept_name)
VALUES (1, 'FINANCE'), (2, 'HR');
INSERT INTO employee (id, name, salary, depart_id)
VALUES 
(1, 'ALICE', 72000, 1), 
(2, 'DAVID', 95000, 1), 
(3, 'LUCAS', 81000, 2), 
(4, 'EMILY', 62000, 2), 
(5, 'NINA', 95000, 1);
SELECT D.DEPT_NAME , E.NAME , E.SALARY , E.DEPART_ID
FROM EMPLOYEE AS E
INNER JOIN DEPART AS D ON E.DEPART_ID = D.ID
WHERE E.SALARY IN (
 SELECT MAX(E2.SALARY)
 FROM EMPLOYEE AS E2
 WHERE E2.DEPART_ID = E.DEPART_ID
)
ORDER BY D.DEPT_NAME;

--Hard Level Problem

CREATE TABLE TABLEA (
    EMPID INT PRIMARY KEY,
    ENAME VARCHAR(50),
    SALARY INT
);
CREATE TABLE TABLEB (
    EMPID INT,
    ENAME VARCHAR(50),
    SALARY INT
);
INSERT INTO TABLEA (EMPID,ENAME,SALARY)
VALUES (1,'OLIVER',1200), (2,'SOPHIA',500);
INSERT INTO TABLEB (EMPID,ENAME,SALARY)
VALUES (2,'SOPHIA',650), (3,'ETHAN',200);
-- Group only by EMPID
SELECT EMPID , MIN(ENAME) AS ENAME, MIN(SALARY) AS SALARY
FROM (
    SELECT * FROM TABLEA
    UNION ALL
    SELECT * FROM TABLEB
) AS INTERMEDIATE_RESULT
GROUP BY EMPID;
-- Group by EMPID + ENAME
SELECT EMPID , ENAME, MIN(SALARY) AS SALARY
FROM (
    SELECT * FROM TABLEA
    UNION ALL
    SELECT * FROM TABLEB
) AS INTERMEDIATE_RESULT
GROUP BY EMPID , ENAME;
